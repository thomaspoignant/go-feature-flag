(self.webpackChunkgo_feature_flag_website=self.webpackChunkgo_feature_flag_website||[]).push([[15148],{7411:()=>{},28825:()=>{},62144:e=>{function a(e){return Promise.resolve().then(()=>{var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a})}a.keys=()=>[],a.resolve=a,a.id=62144,e.exports=a},67992:()=>{},93290:()=>{},97286:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>be});var l=s(96540),n=s(49785),r=s(85424);const t={flagContainer:"flagContainer_wy3i"};var i=s(34164);const o={editorInputContainer:"editorInputContainer_jqCm",editorCut:"editorCut_Erbg",error:"error_AEli",editorPlaceholder:"editorPlaceholder_MvV8",editorInput:"editorInput_WHYK",errorMessage:"errorMessage_K08I"};var c=s(10203),d=s(5556),u=s.n(d),m=s(74848);function p({label:e,displayText:a,className:s,required:l,type:r,validation:t,defaultValue:d,controlled:u=!1,disablePlaceholder:p=!1,disableInlineErr:g=!1,...x}){const{register:h}=(0,n.xW)();const f=h(e,{required:{value:l,message:"This field is required"},...t});return(0,m.jsxs)("div",{className:(0,i.A)(s||o.editorInputContainer),children:[(0,m.jsx)("input",{id:`${e}.input`,defaultValue:d,className:o.editorInput,type:"number"===r?"number":"text",placeholder:" ",...u?{}:f,...x}),p&&(0,m.jsx)("span",{children:a}),(0,m.jsx)("div",{className:o.editorCut}),(0,m.jsx)("label",{htmlFor:`${e}.input`,className:(0,i.A)(o.editorPlaceholder),children:a}),!g&&(0,m.jsx)(c.K,{name:e,render:v})]})}function v({message:e}){return(0,m.jsx)("div",{className:o.errorMessage,children:e})}p.propTypes={label:u().string.isRequired,displayText:u().string,className:u().string,required:u().bool,type:u().string,validation:u().object,defaultValue:u().any,disablePlaceholder:u().bool,disableInlineErr:u().bool,controlled:u().bool};const g={container:"container_JzDm",switch:"switch_G9oQ",r:"r_b74C",layer:"layer_jPCr",knobs:"knobs_MQYY",checkbox:"checkbox_UUwg",displayText:"displayText_acVt"};function x({label:e,displayText:a,defaultChecked:s=!1}){const{register:l}=(0,n.xW)();return(0,m.jsxs)("div",{className:g.container,children:[(0,m.jsx)("div",{className:(0,i.A)(g.displayText),children:a}),(0,m.jsx)("div",{children:(0,m.jsxs)("div",{className:(0,i.A)(g.switch,g.r),children:[(0,m.jsx)("input",{type:"checkbox",className:g.checkbox,...l(e),defaultChecked:s}),(0,m.jsx)("div",{className:g.knobs}),(0,m.jsx)("div",{className:g.layer})]})})]})}x.propTypes={label:u().string.isRequired,displayText:u().string,defaultChecked:u().bool};const h={selector:"selector_zSAl"};function f({title:e,content:a,label:s,required:l,controlled:r=!1,...t}){const{register:i}=(0,n.xW)(),o=i(s,l);return(0,m.jsx)("div",{className:h.selector,children:(0,m.jsxs)("select",{defaultValue:"0",...r?{}:o,...t,children:[(0,m.jsx)("option",{disabled:!0,defaultChecked:!0,value:null,children:e}),a.map(e=>(0,m.jsx)("option",{value:e.value,children:e.displayName},`variation_type_${e.value}_${e.displayText}`))]})})}f.propTypes={title:u().string,content:u().array,label:u().string.isRequired,required:u().bool,controlled:u().bool};const b={buttonPlus:"buttonPlus_vxig",bg:"bg_ZMMU",variation:"variation_m8Hn",icons:"icons_NekN",icon:"icon_PBCB",targeting:"targeting_UFjj"};var j=s(66713),y=s(95293);const N={container:"container_SLwd"};function _({label:e,value:a}){const{register:s}=(0,n.xW)(),{colorMode:l}=(0,y.G)(),{onChange:r,onBlur:t,name:i,ref:o}=s(`${e}.value`);return(0,m.jsx)("div",{className:N.container,"data-color-mode":l,children:(0,m.jsx)(j.A,{value:a||"",language:"json",placeholder:" Please enter JSON.",padding:7,className:N.container,onChange:r,onBlur:t,name:i,ref:o,"data-color-mode":l,style:{fontFamily:"ui-monospace,SFMono-Regular,SF Mono,Consolas,Liberation Mono,Menlo,monospace"}})})}_.propTypes={label:u().string.isRequired};const C=["\ud83d\udfe2","\ud83d\udfe0","\ud83d\udd34","\ud83d\udfe3","\u26aa\ufe0f","\ud83d\udd35","\u26ab\ufe0f","\ud83d\udfe1","\ud83d\udfe4"];function k({type:e,label:a}){const{control:s}=(0,n.xW)(),{fields:l,append:r,remove:t}=(0,n.jz)({control:s,name:a,rules:{minLength:1}}),o=e=>t(e);return(0,m.jsxs)("div",{children:[(0,m.jsx)("h2",{children:"Variations"}),(0,m.jsx)("div",{className:"grid grid-cols-12",children:l.map((s,l)=>(0,m.jsx)(T,{type:e,label:`${a}.${l}`,index:l,remove:o,icon:C[l%C.length]},s.id))}),(0,m.jsx)("button",{className:b.buttonPlus,onMouseDown:()=>r({}),children:(0,m.jsxs)("span",{className:"fa-stack fa-1x",children:[(0,m.jsx)("i",{className:(0,i.A)("fa-solid fa-circle fa-stack-2x",b.bg)}),(0,m.jsx)("i",{className:"fa-solid fa-plus fa-stack-1x fa-inverse"})]})})]})}function T({type:e,label:a,remove:s,index:l,icon:r}){const{register:t}=(0,n.xW)();return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{className:(0,i.A)("col-span-5 mb-5 pb-1",b.icons),children:[(0,m.jsx)("div",{className:b.icon,children:r}),(0,m.jsx)(p,{displayText:"Name",label:`${a}.name`,required:!0})]}),(0,m.jsx)("div",{className:(0,i.A)("col-span-6"),children:((e,a,s)=>e&&"JSON"===e.toUpperCase()?(0,m.jsx)(_,{register:s,required:!0,label:a}):(0,m.jsx)(p,{displayText:"Flag Value",label:a,type:e,required:!0}))(e,a+".value",t)}),(0,m.jsx)("div",{className:"col-span-1",children:(0,m.jsx)("button",{className:b.buttonPlus,onMouseDown:e=>{e.preventDefault(),s(l)},children:(0,m.jsxs)("span",{className:"fa-stack fa-1x",children:[(0,m.jsx)("i",{className:(0,i.A)("fa-solid fa-circle fa-stack-2x",b.bg)}),(0,m.jsx)("i",{className:"fa-solid fa-minus fa-stack-1x fa-inverse"})]})})})]})}k.propTypes={type:u().string,label:u().string.isRequired},T.propTypes={type:u().string,label:u().string.isRequired,remove:u().func.isRequired,index:u().number.isRequired,icon:u().string};const $={ruleContainer:"ruleContainer__VKe",ruleName:"ruleName_UKzC",removeButton:"removeButton_vXAy",bg:"bg_A2w1",ruleKeyValueContainer:"ruleKeyValueContainer_Ator",circle:"circle_Gmme",inputQuery:"inputQuery_ajTA",ifContainer:"ifContainer_dti2",serveTitle:"serveTitle_zpaJ",operatorContainer:"operatorContainer_fVk4",serve:"serve_AhaS",percentageInput:"percentageInput_tEMG",dateInput:"dateInput_aE4X",percentageContainer:"percentageContainer_Mre8",error:"error_izBb",rolloutDesc:"rolloutDesc_kHMj",progressiveRollout:"progressiveRollout_x7nm",progressiveRolloutPercentage:"progressiveRolloutPercentage_qZik",formError:"formError_TtL5"};var q=s(65563),w=s(89239),A=(s(81180),s(28794)),O=s(2195);function D({variations:e,label:a,selectedVar:s=""}){const{register:l,watch:r}=(0,n.xW)();return"percentage"!==s?null:(0,m.jsxs)("div",{className:"grid-pad grid",children:[(0,m.jsx)("div",{className:(0,i.A)("col-1-1",$.rolloutDesc),children:"A percentage rollout means that your users are divided in different buckets and you serve different variations to them. Note that a user will always have the same variation."}),(0,m.jsxs)("div",{className:"col-1-2",children:[(0,m.jsx)("ul",{className:$.percentageContainer,children:e.map((e,s)=>(0,m.jsxs)("li",{children:[(0,m.jsx)(p,{label:`${a}.${s}.value`,required:!0,defaultValue:0,type:"number",displayText:`%  ${C[s%C.length]} ${e.name}`,className:$.percentageInput,disablePlaceholder:!0,disableInlineErr:!0,validation:{valueAsNumber:!0,required:{value:!0,message:"Percentage field is required"},min:{value:0,message:"Percentage should be between 0 and 100"},max:{value:100,message:"Percentage should be between 0 and 100"}}}),(0,m.jsx)("input",{type:"hidden",...l(`${a}.${s}.name`),value:e.name})]},`${a}.${e.name}`))}),(0,m.jsx)(V,{percentages:r(a)})]})]})}function V({percentages:e}){if(!e||!(0,A.isArray)(e)||e.length<=0)return null;const a=e.filter(e=>e&&!isNaN(e.value)).reduce((e,a)=>e+a.value,0);return a>100?(0,m.jsx)("div",{className:$.error,children:"The total percentage cannot be more than 100%"}):(0,m.jsx)(O.Progress,{percent:a})}D.propTypes={variations:u().array,label:u().string.isRequired,selectedVar:u().string},V.propTypes={percentages:u().array};var R=s(2543),E=s.n(R),S=s(54626),P=s(28774);function F({name:e,initialValue:a,label:s,variations:l,defaultDate:r}){const{register:t,control:o,formState:{errors:c}}=(0,n.xW)();return(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{className:(0,i.A)("grid",$.progressiveRollout),children:[(0,m.jsx)("div",{children:e}),(0,m.jsx)("div",{children:(0,m.jsx)(n.xI,{control:o,name:`${s}.date`,defaultValue:r,rules:{required:{value:!0,message:"Date field is required"}},render:({field:e})=>(0,m.jsx)(S.Ay,{className:$.dateInput,placeholderText:"Select date",showTimeSelect:!0,onChange:a=>e.onChange(a),selected:e.value,dateFormat:"Pp"})})}),(0,m.jsx)("div",{children:"and serve"}),(0,m.jsx)("div",{children:(0,m.jsx)(f,{title:"Variation",content:l.map((e,a)=>({value:e.name,displayName:`${C[a%C.length]} ${e.name}`})).filter(e=>void 0!==e.value&&""!==e.value)||[],register:t,label:`${s}.selectedVar`,required:!0})}),(0,m.jsxs)("div",{className:$.progressiveRolloutPercentage,children:["to\xa0",(0,m.jsx)(p,{label:`${s}.percentage`,required:!0,defaultValue:a,type:"number",displayText:"%",className:$.percentageInput,disablePlaceholder:!0,disableInlineErr:!0,validation:{valueAsNumber:!0,min:{value:0,message:"Percentage should be between 0 and 100"},max:{value:100,message:"Percentage should be between 0 and 100"}}})]}),(0,m.jsx)("div",{children:(0,m.jsx)(P.A,{to:"/docs/configure_flag/rollout/progressive",target:"_blank",children:(0,m.jsx)("i",{className:"fa-regular fa-circle-question"})})})]}),(0,m.jsx)("div",{children:(0,m.jsx)(I,{errors:c,label:s})})]})}function I(e,a){const s=E().get(e,a);return E().isNil(s)?null:(0,m.jsx)("ul",{className:$.formError,children:Object.keys(s).map(e=>(0,m.jsx)("li",{children:s[e].message},e))})}function M({variations:e,label:a,selectedVar:s}){if("progressive"!==s)return null;let l=new Date;return l=l.setDate(l.getDate()+10),(0,m.jsxs)("div",{className:"grid grid-pad",children:[(0,m.jsxs)("div",{className:(0,i.A)("col-1-1",$.rolloutDesc),children:["A progressive rollout allows you to increase the percentage of your flag over time.",(0,m.jsx)("br",{}),"You can select a release ramp where the percentage of your flag will increase progressively between the start date and the end date."]}),(0,m.jsx)(F,{name:"Start on the",label:`${a}.initial`,variations:e,initialValue:0,defaultDate:new Date}),(0,m.jsx)(F,{name:"Stop on the",label:`${a}.end`,variations:e,initialValue:100,defaultDate:new Date(l)})]})}F.propTypes={name:u().string,initialValue:u().number,label:u().string.isRequired,variations:u().array,defaultDate:u().any},M.propTypes={variations:u().array,label:u().string.isRequired,selectedVar:u().string};var W=s(49852),J=s(12288);s(85677);function G({variations:e,label:a,isDefaultRule:s}){const[r,t]=(0,l.useState)({combinator:"and",rules:[{field:"",operator:"eq",value:""}]}),{register:c,watch:d,setValue:u}=(0,n.xW)(),v=[{value:"percentage",displayName:"\ufe0f\u2197\ufe0f a percentage rollout"},{value:"progressive",displayName:"\u2197\ufe0f a progressive rollout"}],g=(0,l.useCallback)(e=>{u(`${a}.query`,Y(e)),t(e)},[Y,u,t,a]);return(0,m.jsxs)("div",{className:(0,i.A)("grid-pad grid",$.ruleContainer),children:[!s&&(0,m.jsx)("div",{className:"col-1-1",children:(0,m.jsx)("div",{className:"content",children:(0,m.jsx)(p,{label:`${a}.name`,displayText:"Rule name",className:(0,i.A)(o.editorInputContainer,$.ruleName),required:!0})})}),!s&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("input",{name:`${a}.query`,type:"hidden",...c(`${a}.query`)}),(0,m.jsx)(J.qy,{dnd:{...q,...w},children:(0,m.jsx)(W.oS,{fields:[],controlElements:{fieldSelector:L,valueEditor:L,operatorSelector:z,combinatorSelector:K,addGroupAction:({handleOnClick:e})=>(0,m.jsx)(U,{handleOnClick:e,variant:"group"}),addRuleAction:({handleOnClick:e})=>(0,m.jsx)(U,{handleOnClick:e,variant:"rule"}),removeGroupAction:({handleOnClick:e})=>(0,m.jsx)(B,{handleOnClick:e,variant:"group"}),removeRuleAction:({handleOnClick:e})=>(0,m.jsx)(B,{handleOnClick:e,variant:"rule"})},resetOnFieldChange:!1,resetOnOperatorChange:!1,addRuleToNewGroups:!0,operators:H,query:r,onQueryChange:g})})]}),(0,m.jsx)("div",{className:"col-5-12",children:(0,m.jsxs)("div",{className:(0,i.A)("content",$.serve),children:[(0,m.jsx)("div",{className:$.serveTitle,children:"Serve"}),(0,m.jsx)(f,{title:"Variation",content:function(e){const a=function(e){return e.map((e,a)=>({value:e.name,displayName:`${C[a%C.length]} ${e.name}`})).filter(e=>void 0!==e.value&&""!==e.value)||[]}(e);return a.length>=2?[...a,...v]:a}(e),label:`${a}.selectedVar`,required:!0})]})}),(0,m.jsxs)("div",{className:"col-1-1",children:[(0,m.jsx)(D,{selectedVar:d(`${a}.selectedVar`),variations:e,label:`${a}.percentages`}),(0,m.jsx)(M,{selectedVar:d(`${a}.selectedVar`),variations:e,label:`${a}.progressive`})]})]})}function L({handleOnChange:e,title:a,value:s,disabled:l,testID:n}){return(0,m.jsx)("div",{children:(0,m.jsx)(p,{"data-testid":n,value:s,label:a,displayText:a,disabled:l,controlled:!0,required:!0,onChange:a=>e(a.target.value)})})}function z({options:e,handleOnChange:a,title:s}){const n=(0,l.useMemo)(()=>e.map(({name:e,label:a})=>({value:e,displayName:a})),[e]);return(0,m.jsx)(f,{content:n,controlled:!0,label:"Operator",onChange:e=>a(e.target.value),required:!1,title:s})}function K({options:e,handleOnChange:a,title:s}){const n=(0,l.useMemo)(()=>e.map(({name:e,label:a})=>({value:e,displayName:a})),[e]);return(0,m.jsx)("div",{style:{maxWidth:"8rem"},children:(0,m.jsx)(f,{content:n,controlled:!0,label:"Operator",onChange:e=>a(e.target.value),required:!1,title:s})})}function B({handleOnClick:e,variant:a}){const s=(0,l.useCallback)(()=>{switch(a){case"group":return"fa-xmark";case"rule":return"fa-minus"}},[a]);return(0,m.jsx)("button",{className:$.removeButton,onClick:e,children:(0,m.jsxs)("span",{className:"fa-stack fa-1x",children:[(0,m.jsx)("i",{className:(0,i.A)("fa-solid fa-circle fa-stack-2x",$.bg)}),(0,m.jsx)("i",{className:`fa-solid ${s()} fa-stack-1x fa-inverse`})]})})}function U({handleOnClick:e,variant:a}){const s=(0,l.useMemo)(()=>{switch(a){case"group":return"+Group";case"rule":return"+Rule"}},[a]);return(0,m.jsx)("button",{className:"pushy__btn pushy__btn--md pushy__btn--black",onClick:e,children:s})}function Y(e){if(!e.combinator||!e.rules||!Array.isArray(e.rules))throw new Error("Invalid JSON format for the query.");return e.rules.map(function e(a){let s="";if(a.field&&a.operator&&(s+=`${a.field} ${a.operator}`,a.value&&("in"===a.operator?s+=` ${function(e){const a=e.split(",").map(e=>{const a=e.trim();return Q(a)?parseInt(a,10):a.replace(/^"(.*)"$/,"$1")});return JSON.stringify(a)}(a.value)}`:s+=Q(a.value)?` ${a.value}`:` "${a.value}"`)),a.rules&&a.rules.length>0){s+=` (${a.rules.map(e).join(` ${a.combinator} `)}) `}return s.trim()}).join(` ${e.combinator} `)}function Q(e){return/^-?\d+$/.test(e)}G.propTypes={variations:u().array,label:u().string.isRequired,isDefaultRule:u().bool},L.propTypes={className:u().string,handleOnChange:u().func,title:u().string,value:u().string,disabled:u().bool,testID:u().string},z.propTypes={handleOnChange:u().func,options:u().array,title:u().string},K.propTypes={handleOnChange:u().func,options:u().array,title:u().string},B.propTypes={handleOnClick:u().func,variant:u().string},U.propTypes={handleOnClick:u().func,variant:u().string};const H=[{name:"eq",label:"Equals To"},{name:"ne",label:"Not Equals To"},{name:"lt",label:"Less Than"},{name:"gt",label:"Greater Than"},{name:"le",label:"Less Than Equal To"},{name:"ge",label:"Greater Than Equal To"},{name:"co",label:"Contains"},{name:"sw",label:"Starts With"},{name:"ew",label:"Ends With"},{name:"in",label:"In a List"},{name:"pr",label:"Present"},{name:"not",label:"Not"}],Z={button:"button_Kroe",bg:"bg_rAJd",targeting:"targeting_TgyP",variation:"variation_eQWz",icons:"icons_PYIv",icon:"icon_fDeV"};function X({label:e,variations:a}){const{control:s}=(0,n.xW)(),{fields:r,append:t,remove:o,update:c}=(0,n.jz)({control:s,name:e}),d=(0,l.useCallback)(()=>t({name:`Rule ${r.length+1}`}),[]),u=(0,l.useCallback)(e=>o(e),[]);return(0,m.jsxs)("div",{children:[(0,m.jsx)("h2",{children:"Target specific users"}),r.length<=0&&(0,m.jsx)("div",{children:"Add Rule"}),r.map((s,l)=>(0,m.jsxs)("div",{className:(0,i.A)(Z.targeting),children:[(0,m.jsx)(G,{variations:a,label:`${e}.${l}`,isDefaultRule:!1}),(0,m.jsx)("button",{className:Z.button,onMouseDown:u,children:(0,m.jsxs)("span",{className:"fa-stack fa-1x",children:[(0,m.jsx)("i",{className:(0,i.A)("fa-solid fa-circle fa-stack-2x",Z.bg)}),(0,m.jsx)("i",{className:"fa-solid fa-xmark fa-stack-1x fa-inverse"})]})})]},s.id)),(0,m.jsx)("button",{className:Z.button,onMouseDown:d,children:(0,m.jsxs)("span",{className:"fa-stack fa-1x",children:[(0,m.jsx)("i",{className:(0,i.A)("fa-solid fa-circle fa-stack-2x",Z.bg)}),(0,m.jsx)("i",{className:"fa-solid fa-plus fa-stack-1x fa-inverse"})]})})]})}X.propTypes={label:u().string.isRequired,variations:u().array};const ee={buttonPlus:"buttonPlus_bivi",bg:"bg_h80t",variation:"variation_HZEP",icons:"icons_clfx",icon:"icon_tZKN",targeting:"targeting_xoeT"};function ae({label:e}){const{control:a}=(0,n.xW)(),{fields:s,append:l,remove:r}=(0,n.jz)({control:a,name:e,rules:{minLength:1}}),t=e=>r(e);return(0,m.jsxs)("div",{children:[(0,m.jsx)("h2",{children:"Metadata"}),s.length<=0&&(0,m.jsx)("div",{children:"Add new metadata to your flag"}),(0,m.jsx)("div",{className:"grid grid-pad",children:s.map((a,s)=>(0,m.jsx)(se,{label:`${e}.${s}`,index:s,remove:t},a.id))}),(0,m.jsx)("button",{className:ee.buttonPlus,onMouseDown:()=>l({name:"",value:""}),children:(0,m.jsxs)("span",{className:"fa-stack fa-1x",children:[(0,m.jsx)("i",{className:(0,i.A)("fa-solid fa-circle fa-stack-2x",ee.bg)}),(0,m.jsx)("i",{className:"fa-solid fa-plus fa-stack-1x fa-inverse"})]})})]})}function se({type:e,label:a,remove:s,index:l,icon:r}){const{register:t}=(0,n.xW)();return(0,m.jsxs)("div",{className:ee.variation,children:[(0,m.jsxs)("div",{className:(0,i.A)("col-4-12 mobile-col-5-12",ee.icons),children:[(0,m.jsx)("div",{className:ee.icon,children:r}),(0,m.jsx)(p,{displayText:"Key",label:`${a}.name`,register:t})]}),(0,m.jsx)("div",{className:(0,i.A)("col-6-12 mobile-col-7-12"),children:(0,m.jsx)(p,{displayText:"Value",label:`${a}.value`,register:t,type:e})}),(0,m.jsx)("div",{className:"col-1-12 mobile-col-1-12",children:(0,m.jsx)("button",{className:ee.buttonPlus,onMouseDown:e=>{e.preventDefault(),s(l)},children:(0,m.jsxs)("span",{className:"fa-stack fa-1x",children:[(0,m.jsx)("i",{className:(0,i.A)("fa-solid fa-circle fa-stack-2x",ee.bg)}),(0,m.jsx)("i",{className:"fa-solid fa-minus fa-stack-1x fa-inverse"})]})})})]})}function le(e){const a=e.type,s={};e.variations.filter(e=>void 0!==e.name&&""!==e.name&&void 0!==e.value&&""!==e.value).forEach(e=>s[e.name]=ne(e.value,a));const l=e.targeting.map(e=>te(e)),n=ne(e.trackEvents,"boolean"),r=ne(e.disable,"boolean"),t=te(e.defaultRule);return{variations:s,disable:r||void 0,trackEvents:n?void 0:n,version:""===e.version?void 0:e.version,targeting:l.length>0?l:void 0,defaultRule:t,metadata:re(e.metadata)}}function ne(e,a){switch(a){case"json":try{return JSON.parse(e.value)}catch(s){return}case"number":return Number(e)||void 0;case"boolean":return"boolean"==typeof e?e:void 0!==e&&("string"==typeof e||e instanceof String)&&"true"===e.toLowerCase();default:return String(e)||void 0}}function re(e){if(void 0!==e&&0!==e.filter(({name:e})=>""!==e).length)return Object.assign({},...e.map(({name:e,value:a})=>({[e]:a})))}function te(e){let a,s,l;const{selectedVar:n}=e;switch(n){case"percentage":s={},e.percentages.forEach(e=>s[e.name]=e.value);break;case"progressive":l={initial:{variation:e.progressive.initial.selectedVar,percentage:e.progressive.initial.percentage||0,date:e.progressive.initial.date},end:{variation:e.progressive.end.selectedVar,percentage:e.progressive.end.percentage||100,date:e.progressive.end.date}};break;default:a=n}return{name:e.name||void 0,query:e.query,variation:a,percentage:s,progressiveRollout:l}}ae.propTypes={label:u().string.isRequired},se.propTypes={label:u().string.isRequired,remove:u().func.isRequired,index:u().number.isRequired};var ie=s(44586);const oe={buttonContainer:"buttonContainer_m7Nq"};function ce({flagInfo:e}){const{siteConfig:a}=(0,ie.A)(),{watch:s}=(0,n.xW)();let r=s(),t=e.split(".");for(let l of t)r=r[l];const o=r.flagName,c=le(r),[d,u]=(0,l.useState)({resolutionDetail:void 0,err:void 0});return(0,m.jsxs)("div",{children:[(0,m.jsx)("h2",{children:"Test your flag"}),(0,m.jsxs)("div",{className:"grid grid-cols-12",children:[(0,m.jsxs)("div",{className:"col-span-5",children:[(0,m.jsx)("h4",{children:"Evaluation Context"}),(0,m.jsx)(_,{label:`${e}.context`,value:JSON.stringify({key:"aae1cb41-c3cb-4753-a117-031ddc958e81",custom:{anonymous:!0,firstname:"John",lastname:"Doe",email:"john.doe@gofeatureflag.org",company:"GO Feature Flag"}}," ",2)})]}),(0,m.jsx)("div",{className:(0,i.A)("col-span-2",oe.buttonContainer),children:(0,m.jsx)("button",{className:"pushy__btn pushy__btn--md pushy__btn--black",onClick:async e=>{e.preventDefault();try{const e=await fetch(a.customFields.playgroundEvaluationApi,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({flagName:o,flag:c,context:r.context.value?JSON.parse(r.context.value):{}})});200===e.status&&e.json().then(e=>u({resolutionDetail:e}))}catch(s){u({err:s.toString()})}},children:"Evaluate Flag"})}),(0,m.jsxs)("div",{className:"col-span-5",children:[(0,m.jsx)("h4",{children:"Flag evaluation Details"}),(0,m.jsxs)("div",{children:[void 0!==d.resolutionDetail&&(0,m.jsxs)("ul",{children:[(0,m.jsxs)("li",{children:["Value: ",d.resolutionDetail.value.toString()]}),(0,m.jsxs)("li",{children:["Variation Type: ",d.resolutionDetail.variationType]}),(0,m.jsxs)("li",{children:["Reason: ",d.resolutionDetail.reason]}),(0,m.jsxs)("li",{children:["Failed: ",d.resolutionDetail.failed]}),(0,m.jsxs)("li",{children:["Error Code: ",d.resolutionDetail.errorCode]}),(0,m.jsxs)("li",{children:["Track Events: ",d.resolutionDetail.trackEvents]})]}),void 0!==d.err&&(0,m.jsxs)("span",{children:["Impossible to call the API: ",d.err]})]})]})]})]})}function de({label:e}){const{watch:a}=(0,n.xW)();return(0,m.jsxs)("div",{className:t.flagContainer,children:[(0,m.jsxs)("div",{className:"grid grid-cols-12",children:[(0,m.jsx)("div",{className:"xl:col-span-6 col-span-2 mb-4",children:(0,m.jsx)(p,{displayText:"Flag Name",label:`${e}.flagName`,required:!0})}),(0,m.jsx)("div",{className:"col-span-3",children:(0,m.jsx)(x,{id:"disable",label:`${e}.disable`,displayText:"Disable"})}),(0,m.jsx)("div",{className:"col-span-3",children:(0,m.jsx)(x,{id:"disable",label:`${e}.trackEvents`,displayText:"Track event",defaultChecked:!0})}),(0,m.jsx)("div",{className:"col-span-3",children:(0,m.jsx)(f,{title:"Flag type",content:[{value:"boolean",displayName:"\u2611\ufe0f boolean"},{value:"string",displayName:"\ud83d\udd24 string"},{value:"number",displayName:"\ud83d\udd22 number"},{value:"json",displayName:"\ud83d\udda5 JSON"}],label:`${e}.type`,required:!0})}),(0,m.jsx)("div",{className:"col-start-5 col-span-3",children:(0,m.jsx)(p,{id:"version",label:`${e}.version`,displayText:"Version"})})]}),(0,m.jsx)(k,{label:`${e}.variations`,type:a(`${e}.type`)}),(0,m.jsx)(X,{label:`${e}.targeting`,variations:a(`${e}.variations`)}),(0,m.jsxs)("div",{children:[(0,m.jsx)("h2",{children:"Default"}),(0,m.jsx)(G,{label:`${e}.defaultRule`,variations:a(`${e}.variations`),isDefaultRule:!0})]}),(0,m.jsx)(ae,{label:`${e}.metadata`}),(0,m.jsx)(ce,{flagInfo:e})]})}de.propTypes={label:u().string.isRequired};var ue=s(2681),me=s(94562),pe=s(10009);const ve={invalidForm:"invalidForm_J4Lp",space:"space_Hu3V"};function ge(e){const a={};return e.GOFeatureFlagEditor.filter(e=>void 0!==e.flagName&&""!==e.flagName).forEach(e=>a[e.flagName]=le(e)),a}function xe(){return(0,m.jsx)("div",{className:ve.invalidForm,children:"Error in your configuration, please review the form."})}function he(){const{watch:e,formState:{errors:a}}=(0,n.xW)(),s=e(),l=a&&0===Object.keys(a).length&&Object.getPrototypeOf(a)===Object.prototype;return(0,m.jsxs)("div",{className:"col-4-12",children:[!l&&(0,m.jsx)(xe,{}),l&&(0,m.jsx)(f,{title:"Format",content:[{value:"yaml",displayName:"YAML"},{value:"json",displayName:"JSON"},{value:"toml",displayName:"TOML"}],required:!1,label:"flagFormat"}),(0,m.jsx)("div",{className:ve.space}),l&&(0,m.jsx)(ue.default,{className:"JSON",children:function(e,a){switch(a){case"json":return JSON.stringify(e,null,2);case"toml":return pe.stringify(e);default:return me.default.stringify(e,null,2)}}(ge(s),s.flagFormat)})]})}function fe(){const e="GOFeatureFlagEditor",a=(0,n.mN)({mode:"onChange",defaultValues:{GOFeatureFlagEditor:[{flagName:"my-first-flag",variations:[{name:"Variation_1",value:!0},{name:"Variation_2",value:!1}],targeting:[],defaultRule:{}}]}}),{fields:s,append:l}=(0,n.jz)({control:a.control,name:e,rules:{minLength:1}});return(0,m.jsx)("div",{className:"grid grid-cols-12 gap-4 my-4 ",children:(0,m.jsxs)(n.Op,{...a,children:[(0,m.jsx)("div",{className:"col-span-8",children:(0,m.jsxs)("form",{onSubmit:a.handleSubmit(e=>{e.preventDefault()}),children:[s.map((a,s)=>(0,m.jsx)(de,{label:`${e}.${s}`},a.id)),(0,m.jsxs)("button",{className:Z.button,onClick:e=>{e.preventDefault(),l({flagName:`new-flag-${s.length}`,variations:[{name:"Variation_1",value:!0},{name:"Variation_2",value:!1}],targeting:[],defaultRule:{}})},children:[(0,m.jsxs)("span",{className:"fa-stack fa-1x",children:[(0,m.jsx)("i",{className:(0,i.A)("fa-solid fa-circle fa-stack-2x",Z.bg)}),(0,m.jsx)("i",{className:"fa-solid fa-plus fa-stack-1x fa-inverse"})]}),"Add another flag"]})]})}),(0,m.jsx)("div",{className:"col-span-4 ml-1",children:(0,m.jsx)(he,{})})]})})}function be(){return(0,m.jsx)(r.A,{title:"Edit Your Flag",description:"GO Feature Flag editor is the simplest way to configure your feature flags.",children:(0,m.jsx)(fe,{})})}}}]);