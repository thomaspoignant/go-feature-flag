"use strict";(self.webpackChunkgo_feature_flag_website=self.webpackChunkgo_feature_flag_website||[]).push([[45151],{5204:e=>{e.exports=JSON.parse('{"permalink":"/blog/2024/10/20/breaking-change-java","editUrl":"https://github.com/thomaspoignant/go-feature-flag/tree/main/website/blog/2024-10-20-breaking-change-java/index.md","source":"@site/blog/2024-10-20-breaking-change-java/index.md","title":"(Java) OpenFeature provider improve the internal cache management.","description":"The Java provider has been updated to improve the internal cache management by migrating from guava cache to caffeine cache.","date":"2024-10-20T00:00:00.000Z","tags":[{"inline":true,"label":"openfeature","permalink":"/blog/tags/openfeature"},{"inline":true,"label":"java","permalink":"/blog/tags/java"},{"inline":true,"label":"breaking changes","permalink":"/blog/tags/breaking-changes"}],"readingTime":1.02,"hasTruncateMarker":true,"authors":[{"name":"Thomas Poignant","title":"Creator of GO Feature Flag","url":"https://github.com/thomaspoignant","imageURL":"https://github.com/thomaspoignant.png","key":"thomaspoignant","page":null}],"frontMatter":{"title":"(Java) OpenFeature provider improve the internal cache management.","description":"The Java provider has been updated to improve the internal cache management by migrating from guava cache to caffeine cache.","authors":["thomaspoignant"],"tags":["openfeature","java","breaking changes"]},"unlisted":false,"prevItem":{"title":"Introducing Exporter Metadata in the GO Feature Flag Provider for OpenFeature.","permalink":"/blog/2025/01/21/exporter-metadata"},"nextItem":{"title":"Changes to golang OpenFeature Integration","permalink":"/blog/2024/08/14/changes-to-golang-openfeature-integration"}}')},28453:(e,a,n)=>{n.d(a,{R:()=>o,x:()=>c});var t=n(96540);const i={},r=t.createContext(i);function o(e){const a=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function c(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(r.Provider,{value:a},e.children)}},29832:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>s,contentTitle:()=>c,default:()=>l,frontMatter:()=>o,metadata:()=>t,toc:()=>h});var t=n(5204),i=n(74848),r=n(28453);const o={title:"(Java) OpenFeature provider improve the internal cache management.",description:"The Java provider has been updated to improve the internal cache management by migrating from guava cache to caffeine cache.",authors:["thomaspoignant"],tags:["openfeature","java","breaking changes"]},c=void 0,s={authorsImageUrls:[void 0]},h=[{value:"How to migrate",id:"how-to-migrate",level:2}];function g(e){const a={a:"a",br:"br",code:"code",h2:"h2",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(a.p,{children:["Until Today the java provider, used the guava cache to store the flags and the segments.\nUsing the guava cache is now ",(0,i.jsx)(a.a,{href:"https://javadoc.io/doc/com.google.guava/guava/latest/com/google/common/cache/package-summary.html",children:"discouraged"})," by the guava team."]}),"\n",(0,i.jsxs)(a.p,{children:["In order to follow the guidance of the guava team, we have decided to migrate the internal cache of the Java provider from ",(0,i.jsx)(a.code,{children:"guava"})," to ",(0,i.jsx)(a.code,{children:"caffeine"}),"."]}),"\n",(0,i.jsxs)(a.p,{children:["This may create a ",(0,i.jsx)(a.strong,{children:"breaking change"})," for you if you were using a custom cache configuration with the ",(0,i.jsx)(a.code,{children:"guava"})," cache in your provider.",(0,i.jsx)(a.br,{}),"\n","Because of this, the cache configuration on ",(0,i.jsx)(a.code,{children:"GoFeatureFlagProviderOptions"})," that used Guava's ",(0,i.jsx)(a.code,{children:"CacheBuilder"})," is now handled by ",(0,i.jsx)(a.code,{children:"Caffeine"}),"."]}),"\n",(0,i.jsx)(a.h2,{id:"how-to-migrate",children:"How to migrate"}),"\n",(0,i.jsx)(a.p,{children:"Configuration cache with Guava used to be like this:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-java",children:'import com.google.common.cache.CacheBuilder;\n// ...\nCacheBuilder guavaCacheBuilder = CacheBuilder.newBuilder()\n  .initialCapacity(100)\n  .maximumSize(2000);\n\nFeatureProvider provider = new GoFeatureFlagProvider(\n  GoFeatureFlagProviderOptions\n  .builder()\n  .endpoint("https://my-gofeatureflag-instance.org")\n  .cacheBuilder(guavaCacheBuilder)\n  .build());\n\nOpenFeatureAPI.getInstance().setProviderAndWait(provider);\n\n// ...\n'})}),"\n",(0,i.jsx)(a.p,{children:"Now with Caffeine it should be like this:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-java",children:'import com.github.benmanes.caffeine.cache.Caffeine;\n// ...\nCaffeine caffeineCacheConfig = Caffeine.newBuilder()\n  .initialCapacity(100)\n  .maximumSize(2000);\n\nFeatureProvider provider = new GoFeatureFlagProvider(\n  GoFeatureFlagProviderOptions\n  .builder()\n  .endpoint("https://my-gofeatureflag-instance.org")\n  .cacheConfig(caffeineCacheConfig)\n  .build());\n\nOpenFeatureAPI.getInstance().setProviderAndWait(provider);\n\n// ...\n'})}),"\n",(0,i.jsxs)(a.p,{children:["For a complete list of customizations  options available in Caffeine, please refer to the ",(0,i.jsx)(a.a,{href:"https://github.com/ben-manes/caffeine/wiki",children:"Caffeine documentation"})," for more details."]})]})}function l(e={}){const{wrapper:a}={...(0,r.R)(),...e.components};return a?(0,i.jsx)(a,{...e,children:(0,i.jsx)(g,{...e})}):g(e)}}}]);