---
sidebar_position: 30
description: How to configure a kubernetes secret retriever.
---
import { integrations } from "@site/data/integrations";
import {Mandatory, NotMandatory} from "@site/src/components/checks/checks";
export const retrieverName = 'Kubernetes Secret'
export const info = integrations.retrievers.find((r) => r.name === retrieverName)

# Kubernetes Secret

## Overview
{info.longDescription ?? info.description}

The **Kubernetes Secret Retriever** will access flags in a Kubernetes Secret via the [Kubernetes Go Client](https://github.com/kubernetes/client-go).

## Add a flag configuration file as Secret
If you have a flag configuration file, you can create a Secret with the content of the file.
The following command will create a Secret with the content of the `examples/retriever_k8s_secret/flags.goff.yaml` file:
```shell
kubectl create secret generic goff --from-file=examples/retriever_k8s_secret/flags.goff.yaml
```
## Configure the relay proxy

To configure your relay proxy to use the {retrieverName} retriever, you need to add the following
configuration to your relay proxy configuration file:

:::note
Relay proxy is only supporting the secrets while running inside the kubernetes cluster.
:::

```yaml title="goff-proxy.yaml"
# ...
retrievers:
  - kind: secret
    namespace: default
    secret: goff
    key: flags.goff.yaml
# ...
```

| Field name  |   Mandatory   | Type   | Default  | Description                                                                                                 |
|-------------|:-------------:|--------|----------|-------------------------------------------------------------------------------------------------------------|
| `kind`      | <Mandatory /> | string | **none** | Value should be **`secret`**.<br/>_This field is mandatory and describes which retriever you are using._ |
| `namespace` | <Mandatory /> | string | **none** | This is the name of the namespace where your **secret** is located _(ex: `default`)_.                    |
| `secret`    | <Mandatory /> | string | **none** | Name of the **secret** we should read  _(ex: `feature-flag`)_.                                           |
| `key`       | <Mandatory /> | string | **none** | Name of the `key` in the **secret** which contains the flag.                                             |

## Configure the GO Module
To configure your GO module to use the {retrieverName} retriever, you need to add the following
configuration to your `ffclient.Config{}` object:

```go title="example.go"
import (
    restclient "k8s.io/client-go/rest"
)
// ...
config, _ := restclient.InClusterConfig()
err = ffclient.Init(ffclient.Config{
    PollingInterval: 3 * time.Second,
    Retriever: &k8sretriever.SecretRetriever{
        Path:           "flags.goff.yaml",
        Namespace:      "default"
        SecretName:     "secret"
        SecretKey:      "flags.yml"
        ClientConfig:   &config
    },
})
defer ffclient.Close()
```

| Field               |   Mandatory   | Description                                        |
|---------------------|:-------------:|----------------------------------------------------|
| **`Namespace`**     | <Mandatory /> | The namespace of the Secret.                    |
| **`SecretName`** | <Mandatory /> | The name of the Secret.                         |
| **`SecretKey`**           | <Mandatory /> | The key within the Secret storing the flags.    |
| **`ClientConfig`**  | <Mandatory /> | The configuration object for the Kubernetes client |